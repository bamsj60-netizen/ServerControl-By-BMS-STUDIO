<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ServerControl By BMS STUDIO</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        * { font-family: 'Plus Jakarta Sans', sans-serif; }
        
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-tertiary: #1a1a25;
            --bg-hover: #22222f;
            --text-primary: #f0f0f5;
            --text-secondary: #8888a0;
            --accent: #6366f1;
            --accent-light: #818cf8;
            --accent-dark: #4f46e5;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --border: #2a2a3a;
        }
        
        .light-theme {
            --bg-primary: #f5f5f8;
            --bg-secondary: #ffffff;
            --bg-tertiary: #e8e8f0;
            --bg-hover: #dcdce5;
            --text-primary: #1a1a25;
            --text-secondary: #6b6b80;
            --border: #d0d0e0;
        }
        
        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            backdrop-filter: blur(20px);
        }
        
        .sidebar {
            background: var(--bg-secondary);
            border-right: 1px solid var(--border);
        }
        
        .input-field {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }
        
        .input-field:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
            outline: none;
        }
        
        .input-field::placeholder { color: var(--text-secondary); }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn-primary:hover::before { left: 100%; }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
        }
        
        .btn-danger { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .btn-success { background: linear-gradient(135deg, #10b981, #059669); }
        .btn-warning { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .btn-secondary { background: var(--bg-tertiary); border: 1px solid var(--border); }
        
        .nav-item {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-left: 3px solid transparent;
        }
        
        .nav-item:hover {
            background: var(--bg-hover);
            border-left-color: var(--accent-light);
        }
        
        .nav-item.active {
            background: linear-gradient(90deg, rgba(99, 102, 241, 0.15), transparent);
            border-left-color: var(--accent);
        }
        
        .nav-item.active i { color: var(--accent); }
        
        .stat-card {
            background: linear-gradient(145deg, var(--bg-secondary), var(--bg-tertiary));
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--accent), transparent);
            opacity: 0.1;
            border-radius: 0 0 0 100%;
        }
        
        .glow-card { box-shadow: 0 0 40px rgba(99, 102, 241, 0.15); }
        
        .fade-in { animation: fadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-in { animation: slideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .pulse-dot { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.1); }
        }
        
        .float { animation: float 6s ease-in-out infinite; }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .server-card { transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        
        .server-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            border-color: var(--accent);
        }
        
        .modal-backdrop {
            backdrop-filter: blur(8px);
            background: rgba(0,0,0,0.6);
        }
        
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-primary); }
        ::-webkit-scrollbar-thumb { background: var(--bg-tertiary); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--accent); }
        
        .status-online { color: #10b981; }
        .status-offline { color: #ef4444; }
        
        .table-row { transition: all 0.2s ease; }
        .table-row:hover { background: var(--bg-hover); }
        
        .toggle-switch {
            position: relative;
            width: 52px;
            height: 28px;
            background: var(--bg-tertiary);
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid var(--border);
        }
        
        .toggle-switch.active {
            background: var(--accent);
            border-color: var(--accent);
        }
        
        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .toggle-switch.active::after { left: 26px; }
        
        .log-entry {
            border-left: 3px solid var(--accent);
            transition: all 0.2s ease;
        }
        
        .log-entry:hover { background: var(--bg-hover); }
        
        .badge {
            font-size: 11px;
            padding: 4px 10px;
            border-radius: 20px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .icon-box {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }
        
        .progress-bar {
            height: 6px;
            border-radius: 3px;
            background: var(--bg-tertiary);
            overflow: hidden;
        }
        
        .progress-bar-fill {
            height: 100%;
            border-radius: 3px;
            background: linear-gradient(90deg, var(--accent), var(--accent-light));
            transition: width 0.5s ease;
        }
        
        .api-status-connected { background: linear-gradient(135deg, #10b981, #059669); }
        .api-status-error { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .api-status-pending { background: linear-gradient(135deg, #f59e0b, #d97706); }
        
        .loading-spinner {
            border: 3px solid var(--bg-tertiary);
            border-top: 3px solid var(--accent);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .game-thumbnail {
            width: 80px;
            height: 80px;
            border-radius: 12px;
            object-fit: cover;
            background: var(--bg-tertiary);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, var(--accent), #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .code-block {
            background: #1e1e2e;
            border-radius: 8px;
            padding: 12px;
            font-family: 'Fira Code', monospace;
            font-size: 12px;
            overflow-x: auto;
            color: #a6adc8;
        }
        
        .tab-btn {
            padding: 10px 20px;
            border-radius: 10px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .tab-btn.active {
            background: var(--accent);
            color: white;
        }
        
        .tab-btn:not(.active):hover {
            background: var(--bg-hover);
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Login Page -->
    <div id="loginPage" class="min-h-screen flex items-center justify-center p-4 relative overflow-hidden">
        <div class="absolute inset-0 overflow-hidden">
            <div class="absolute top-1/4 left-1/4 w-96 h-96 bg-indigo-500/10 rounded-full blur-3xl float"></div>
            <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl float" style="animation-delay: -3s;"></div>
        </div>
        
        <div class="card rounded-3xl p-8 w-full max-w-md fade-in glow-card relative z-10">
            <div class="text-center mb-8">
                <div class="w-20 h-20 mx-auto mb-6 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center shadow-lg shadow-indigo-500/30 float">
                    <i class="fas fa-server text-3xl text-white"></i>
                </div>
                <h1 class="text-3xl font-bold gradient-text mb-2">ServerControl</h1>
                <p class="text-sm" style="color: var(--text-secondary)">By BMS STUDIO</p>
            </div>
            
            <div class="space-y-5">
                <div>
                    <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">
                        <i class="fas fa-user mr-2"></i>Username / ID
                    </label>
                    <input type="text" id="loginUsername" class="input-field w-full px-4 py-3.5 rounded-xl" placeholder="Masukkan username">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">
                        <i class="fas fa-lock mr-2"></i>Password
                    </label>
                    <input type="password" id="loginPassword" class="input-field w-full px-4 py-3.5 rounded-xl" placeholder="Masukkan password">
                </div>
                <button onclick="login()" class="btn-primary w-full py-4 rounded-xl text-white font-semibold text-lg">
                    <i class="fas fa-sign-in-alt mr-2"></i>Masuk ke Panel
                </button>
            </div>
            <p id="loginError" class="text-red-500 text-sm text-center mt-4 hidden">
                <i class="fas fa-exclamation-circle mr-1"></i>Username atau password salah!
            </p>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div id="dashboard" class="hidden min-h-screen flex">
        <!-- Sidebar -->
        <aside class="sidebar w-72 fixed h-full overflow-y-auto slide-in z-40">
            <div class="p-6">
                <div class="flex items-center gap-4 mb-10">
                    <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center shadow-lg">
                        <i class="fas fa-server text-xl text-white"></i>
                    </div>
                    <div>
                        <h1 class="font-bold text-lg">ServerControl</h1>
                        <p class="text-xs" style="color: var(--text-secondary)">BMS STUDIO</p>
                    </div>
                </div>

                <p class="text-xs font-semibold uppercase tracking-wider mb-4" style="color: var(--text-secondary)">Menu</p>
                
                <nav class="space-y-2">
                    <div onclick="showSection('dashboard-main')" class="nav-item active flex items-center gap-3 px-4 py-3.5 rounded-xl cursor-pointer" data-section="dashboard-main">
                        <i class="fas fa-th-large w-5 text-center"></i>
                        <span>Dashboard</span>
                    </div>
                    <div onclick="showSection('api-keys')" class="nav-item flex items-center gap-3 px-4 py-3.5 rounded-xl cursor-pointer" data-section="api-keys">
                        <i class="fas fa-key w-5 text-center"></i>
                        <span>Roblox API Keys</span>
                        <span class="badge bg-indigo-500/20 text-indigo-400 ml-auto" id="apiKeyCount">0</span>
                    </div>
                    <div onclick="showSection('games')" class="nav-item flex items-center gap-3 px-4 py-3.5 rounded-xl cursor-pointer" data-section="games">
                        <i class="fas fa-gamepad w-5 text-center"></i>
                        <span>My Games</span>
                    </div>
                    <div onclick="showSection('servers')" class="nav-item flex items-center gap-3 px-4 py-3.5 rounded-xl cursor-pointer" data-section="servers">
                        <i class="fas fa-server w-5 text-center"></i>
                        <span>Live Servers</span>
                    </div>
                    <div onclick="showSection('players')" class="nav-item flex items-center gap-3 px-4 py-3.5 rounded-xl cursor-pointer" data-section="players">
                        <i class="fas fa-users w-5 text-center"></i>
                        <span>Players</span>
                    </div>
                    <div onclick="showSection('bans')" class="nav-item flex items-center gap-3 px-4 py-3.5 rounded-xl cursor-pointer" data-section="bans">
                        <i class="fas fa-ban w-5 text-center"></i>
                        <span>Ban System</span>
                    </div>
                    <div onclick="showSection('announcements')" class="nav-item flex items-center gap-3 px-4 py-3.5 rounded-xl cursor-pointer" data-section="announcements">
                        <i class="fas fa-bullhorn w-5 text-center"></i>
                        <span>Announcements</span>
                    </div>
                    <div onclick="showSection('reports')" class="nav-item flex items-center gap-3 px-4 py-3.5 rounded-xl cursor-pointer" data-section="reports">
                        <i class="fas fa-flag w-5 text-center"></i>
                        <span>Player Reports</span>
                        <span class="badge bg-red-500 text-white ml-auto" id="reportBadge">0</span>
                    </div>
                    <div onclick="showSection('logs')" class="nav-item flex items-center gap-3 px-4 py-3.5 rounded-xl cursor-pointer" data-section="logs">
                        <i class="fas fa-clipboard-list w-5 text-center"></i>
                        <span>Admin Logs</span>
                    </div>
                    <div id="createAdminNav" onclick="showSection('create-admin')" class="nav-item hidden items-center gap-3 px-4 py-3.5 rounded-xl cursor-pointer" data-section="create-admin">
                        <i class="fas fa-user-plus w-5 text-center"></i>
                        <span>Create Admin</span>
                    </div>
                    <div onclick="showSection('settings')" class="nav-item flex items-center gap-3 px-4 py-3.5 rounded-xl cursor-pointer" data-section="settings">
                        <i class="fas fa-cog w-5 text-center"></i>
                        <span>Settings</span>
                    </div>
                    <div onclick="showSection('lua-script')" class="nav-item flex items-center gap-3 px-4 py-3.5 rounded-xl cursor-pointer" data-section="lua-script">
                        <i class="fas fa-code w-5 text-center"></i>
                        <span>Lua Script</span>
                    </div>
                </nav>
            </div>

            <div class="absolute bottom-0 left-0 right-0 p-6">
                <div class="card rounded-xl p-4 mb-4">
                    <div class="flex items-center gap-3 mb-3">
                        <div class="w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-bold" id="sidebarAvatar">A</div>
                        <div class="flex-1 min-w-0">
                            <p class="font-medium truncate" id="sidebarUser">Admin</p>
                            <p class="text-xs truncate" style="color: var(--text-secondary)" id="sidebarRole">Developer</p>
                        </div>
                    </div>
                </div>
                <button onclick="logout()" class="w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl bg-red-500/10 text-red-400 hover:bg-red-500/20 transition-all border border-red-500/20">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="ml-72 flex-1 p-8 min-h-screen">
            <!-- Header -->
            <header class="flex items-center justify-between mb-8">
                <div>
                    <h2 class="text-2xl font-bold mb-1" id="sectionTitle">Dashboard</h2>
                    <p class="text-sm" style="color: var(--text-secondary)">
                        <i class="fas fa-circle text-green-500 text-xs mr-2"></i>
                        Selamat datang, <span id="welcomeUser" class="font-medium">Admin</span>
                    </p>
                </div>
                <div class="flex items-center gap-4">
                    <div class="flex items-center gap-3 card px-4 py-2 rounded-xl">
                        <i class="fas fa-sun text-yellow-500"></i>
                        <div onclick="toggleTheme()" class="toggle-switch" id="themeToggle"></div>
                        <i class="fas fa-moon text-indigo-400"></i>
                    </div>
                    <div class="card px-4 py-2.5 rounded-xl flex items-center gap-3">
                        <div class="w-9 h-9 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white text-sm font-bold" id="userAvatar">A</div>
                        <div>
                            <p class="font-medium text-sm" id="currentUser">Admin</p>
                            <p class="text-xs" style="color: var(--text-secondary)" id="currentRole">Developer</p>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Dashboard Section -->
            <section id="section-dashboard-main" class="fade-in">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="stat-card card rounded-2xl p-6 hover:scale-105 transition-all duration-300 cursor-pointer">
                        <div class="flex items-center justify-between mb-4">
                            <div class="icon-box bg-indigo-500/20">
                                <i class="fas fa-gamepad text-indigo-400"></i>
                            </div>
                            <span class="text-green-500 text-sm font-medium flex items-center gap-1">
                                <i class="fas fa-link text-xs"></i>Connected
                            </span>
                        </div>
                        <h3 class="text-3xl font-bold mb-1" id="totalGames">0</h3>
                        <p class="text-sm" style="color: var(--text-secondary)">Connected Games</p>
                    </div>
                    <div class="stat-card card rounded-2xl p-6 hover:scale-105 transition-all duration-300 cursor-pointer">
                        <div class="flex items-center justify-between mb-4">
                            <div class="icon-box bg-green-500/20">
                                <i class="fas fa-server text-green-400"></i>
                            </div>
                            <span class="text-green-500 text-sm font-medium flex items-center gap-1">
                                <i class="fas fa-circle text-xs pulse-dot"></i>Live
                            </span>
                        </div>
                        <h3 class="text-3xl font-bold mb-1" id="totalServers">0</h3>
                        <p class="text-sm" style="color: var(--text-secondary)">Active Servers</p>
                    </div>
                    <div class="stat-card card rounded-2xl p-6 hover:scale-105 transition-all duration-300 cursor-pointer">
                        <div class="flex items-center justify-between mb-4">
                            <div class="icon-box bg-purple-500/20">
                                <i class="fas fa-users text-purple-400"></i>
                            </div>
                        </div>
                        <h3 class="text-3xl font-bold mb-1" id="totalPlayers">0</h3>
                        <p class="text-sm" style="color: var(--text-secondary)">Players Online</p>
                    </div>
                    <div class="stat-card card rounded-2xl p-6 hover:scale-105 transition-all duration-300 cursor-pointer">
                        <div class="flex items-center justify-between mb-4">
                            <div class="icon-box bg-red-500/20">
                                <i class="fas fa-ban text-red-400"></i>
                            </div>
                        </div>
                        <h3 class="text-3xl font-bold mb-1" id="totalBans">0</h3>
                        <p class="text-sm" style="color: var(--text-secondary)">Banned Players</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <div class="card rounded-2xl p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-lg font-bold flex items-center gap-2">
                                <i class="fas fa-gamepad text-indigo-400"></i>
                                Connected Games
                            </h3>
                            <button onclick="showSection('api-keys')" class="btn-primary px-4 py-2 rounded-xl text-white text-sm font-medium flex items-center gap-2">
                                <i class="fas fa-plus"></i>Add Game
                            </button>
                        </div>
                        <div class="space-y-4" id="dashboardGames">
                            <div class="text-center py-8" style="color: var(--text-secondary)">
                                <i class="fas fa-plug text-4xl mb-3 opacity-30"></i>
                                <p>No games connected</p>
                                <p class="text-sm">Add your Roblox API Key to get started</p>
                            </div>
                        </div>
                    </div>

                    <div class="card rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-6 flex items-center gap-2">
                            <i class="fas fa-history text-green-400"></i>
                            Recent Activity
                        </h3>
                        <div class="space-y-4" id="recentActivity">
                            <div class="text-center py-8" style="color: var(--text-secondary)">
                                <i class="fas fa-clipboard-list text-4xl mb-3 opacity-30"></i>
                                <p>No recent activity</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- API Keys Section -->
            <section id="section-api-keys" class="hidden fade-in">
                <div class="card rounded-2xl p-6 mb-6">
                    <div class="flex items-center justify-between mb-6">
                        <div>
                            <h3 class="text-lg font-bold flex items-center gap-2">
                                <i class="fas fa-key text-yellow-500"></i>
                                Roblox Open Cloud API Keys
                            </h3>
                            <p class="text-sm mt-1" style="color: var(--text-secondary)">
                                Connect your Roblox games using Open Cloud API
                            </p>
                        </div>
                        <button onclick="showAddApiKeyModal()" class="btn-primary px-6 py-3 rounded-xl text-white font-medium flex items-center gap-2">
                            <i class="fas fa-plus"></i>
                            Add API Key
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4" id="apiKeyGrid">
                        <div class="text-center py-12 col-span-full" style="color: var(--text-secondary)">
                            <i class="fas fa-key text-5xl mb-4 opacity-30"></i>
                            <p class="text-lg">No API Keys configured</p>
                            <p class="text-sm">Add your Roblox Open Cloud API Key to connect your games</p>
                        </div>
                    </div>
                </div>

                <!-- API Documentation -->
                <div class="card rounded-2xl p-6">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <i class="fas fa-book text-indigo-400"></i>
                        How to Find Universe ID & Get API Key
                    </h3>
                    
                    <!-- Universe ID Section -->
                    <div class="mb-6">
                        <h4 class="font-medium mb-3 flex items-center gap-2">
                            <i class="fas fa-globe text-green-400"></i>
                            Finding Your Universe ID
                        </h4>
                        <div class="space-y-3">
                            <div class="flex gap-4 p-4 rounded-xl" style="background: var(--bg-tertiary)">
                                <div class="w-8 h-8 rounded-full bg-green-500 flex items-center justify-center text-white font-bold text-sm flex-shrink-0">1</div>
                                <div>
                                    <h4 class="font-medium mb-1">Open Roblox Studio</h4>
                                    <p class="text-sm" style="color: var(--text-secondary)">Open your game in Roblox Studio</p>
                                </div>
                            </div>
                            <div class="flex gap-4 p-4 rounded-xl" style="background: var(--bg-tertiary)">
                                <div class="w-8 h-8 rounded-full bg-green-500 flex items-center justify-center text-white font-bold text-sm flex-shrink-0">2</div>
                                <div>
                                    <h4 class="font-medium mb-1">Go to Game Settings</h4>
                                    <p class="text-sm" style="color: var(--text-secondary)">Click <strong>Home → Game Settings → Basic Info</strong></p>
                                </div>
                            </div>
                            <div class="flex gap-4 p-4 rounded-xl" style="background: var(--bg-tertiary)">
                                <div class="w-8 h-8 rounded-full bg-green-500 flex items-center justify-center text-white font-bold text-sm flex-shrink-0">3</div>
                                <div>
                                    <h4 class="font-medium mb-1">Copy Universe ID</h4>
                                    <p class="text-sm" style="color: var(--text-secondary)">Find "Universe ID" field and copy the number</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4 p-4 rounded-xl bg-yellow-500/10 border border-yellow-500/30">
                            <p class="text-sm text-yellow-400">
                                <i class="fas fa-lightbulb mr-2"></i>
                                <strong>Alternative:</strong> Visit your game's page, the URL format is:<br>
                                <code class="text-xs bg-black/30 px-2 py-1 rounded mt-1 inline-block">roblox.com/games/[PlaceID]/GameName</code><br>
                                <span class="text-xs opacity-80">Note: Place ID ≠ Universe ID. Use Studio for correct Universe ID.</span>
                            </p>
                        </div>
                    </div>
                    
                    <!-- API Key Section -->
                    <div>
                        <h4 class="font-medium mb-3 flex items-center gap-2">
                            <i class="fas fa-key text-yellow-400"></i>
                            Getting Open Cloud API Key (Optional)
                        </h4>
                        <div class="space-y-3">
                            <div class="flex gap-4 p-4 rounded-xl" style="background: var(--bg-tertiary)">
                                <div class="w-8 h-8 rounded-full bg-indigo-500 flex items-center justify-center text-white font-bold text-sm flex-shrink-0">1</div>
                                <div>
                                    <h4 class="font-medium mb-1">Go to Creator Dashboard</h4>
                                    <p class="text-sm" style="color: var(--text-secondary)">Visit <a href="https://create.roblox.com/dashboard/credentials" target="_blank" class="text-indigo-400 hover:underline">create.roblox.com/dashboard/credentials</a></p>
                                </div>
                            </div>
                            <div class="flex gap-4 p-4 rounded-xl" style="background: var(--bg-tertiary)">
                                <div class="w-8 h-8 rounded-full bg-indigo-500 flex items-center justify-center text-white font-bold text-sm flex-shrink-0">2</div>
                                <div>
                                    <h4 class="font-medium mb-1">Create API Key</h4>
                                    <p class="text-sm" style="color: var(--text-secondary)">Click "Create API Key", name it, and select your experience</p>
                                </div>
                            </div>
                            <div class="flex gap-4 p-4 rounded-xl" style="background: var(--bg-tertiary)">
                                <div class="w-8 h-8 rounded-full bg-indigo-500 flex items-center justify-center text-white font-bold text-sm flex-shrink-0">3</div>
                                <div>
                                    <h4 class="font-medium mb-1">Set Permissions</h4>
                                    <p class="text-sm" style="color: var(--text-secondary)">Enable: <strong>MessagingService</strong>, <strong>DataStore</strong>, <strong>Universe</strong> access</p>
                                </div>
                            </div>
                            <div class="flex gap-4 p-4 rounded-xl" style="background: var(--bg-tertiary)">
                                <div class="w-8 h-8 rounded-full bg-indigo-500 flex items-center justify-center text-white font-bold text-sm flex-shrink-0">4</div>
                                <div>
                                    <h4 class="font-medium mb-1">Set IP to 0.0.0.0/0</h4>
                                    <p class="text-sm" style="color: var(--text-secondary)">For web access, set CIDR to <code class="bg-black/30 px-1 rounded">0.0.0.0/0</code> (allow all IPs)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Games Section -->
            <section id="section-games" class="hidden fade-in">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="gamesGrid">
                    <div class="text-center py-12 col-span-full" style="color: var(--text-secondary)">
                        <i class="fas fa-gamepad text-5xl mb-4 opacity-30"></i>
                        <p class="text-lg">No games connected</p>
                        <p class="text-sm">Add your API Key first</p>
                    </div>
                </div>
            </section>

            <!-- Servers Section -->
            <section id="section-servers" class="hidden fade-in">
                <div class="flex items-center justify-between mb-6">
                    <div class="flex gap-4">
                        <select id="serverGameFilter" class="input-field px-4 py-2.5 rounded-xl" onchange="filterServersByGame()">
                            <option value="all">All Games</option>
                        </select>
                        <button onclick="refreshAllServers()" class="btn-primary px-4 py-2.5 rounded-xl text-white font-medium flex items-center gap-2">
                            <i class="fas fa-sync-alt"></i>Refresh
                        </button>
                        <button onclick="shutdownAllServers()" class="btn-danger px-4 py-2.5 rounded-xl text-white font-medium flex items-center gap-2">
                            <i class="fas fa-power-off"></i>Shutdown All
                        </button>
                    </div>
                </div>

                <div class="card rounded-2xl p-6">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr style="color: var(--text-secondary)" class="text-left border-b border-gray-700/30">
                                    <th class="pb-4 font-medium">Server ID</th>
                                    <th class="pb-4 font-medium">Game</th>
                                    <th class="pb-4 font-medium">Players</th>
                                    <th class="pb-4 font-medium">Type</th>
                                    <th class="pb-4 font-medium">Owner</th>
                                    <th class="pb-4 font-medium">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="serverTableBody">
                                <tr>
                                    <td colspan="6" class="text-center py-12" style="color: var(--text-secondary)">
                                        <i class="fas fa-server text-4xl mb-3 opacity-30"></i>
                                        <p>No active servers</p>
                                        <p class="text-sm">Servers will appear when players join your game</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Players Section -->
            <section id="section-players" class="hidden fade-in">
                <div class="card rounded-2xl p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-bold flex items-center gap-2">
                            <i class="fas fa-users text-green-400"></i>
                            Online Players
                        </h3>
                        <div class="flex gap-4">
                            <select id="playerGameFilter" class="input-field px-4 py-2.5 rounded-xl">
                                <option value="all">All Games</option>
                            </select>
                            <div class="relative">
                                <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2" style="color: var(--text-secondary)"></i>
                                <input type="text" placeholder="Search player..." class="input-field pl-11 pr-4 py-2.5 rounded-xl w-64" id="playerSearch">
                            </div>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr style="color: var(--text-secondary)" class="text-left border-b border-gray-700/30">
                                    <th class="pb-4 font-medium">Player</th>
                                    <th class="pb-4 font-medium">User ID</th>
                                    <th class="pb-4 font-medium">Game</th>
                                    <th class="pb-4 font-medium">Server</th>
                                    <th class="pb-4 font-medium">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="playerTableBody">
                                <tr>
                                    <td colspan="5" class="text-center py-12" style="color: var(--text-secondary)">
                                        <i class="fas fa-users text-4xl mb-3 opacity-30"></i>
                                        <p>No players online</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Ban System Section -->
            <section id="section-bans" class="hidden fade-in">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-2 card rounded-2xl p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-lg font-bold flex items-center gap-2">
                                <i class="fas fa-ban text-red-400"></i>
                                Banned Players
                            </h3>
                            <button onclick="showBanModal()" class="btn-danger px-4 py-2.5 rounded-xl text-white font-medium flex items-center gap-2">
                                <i class="fas fa-user-slash"></i>Ban Player
                            </button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead>
                                    <tr style="color: var(--text-secondary)" class="text-left border-b border-gray-700/30">
                                        <th class="pb-4 font-medium">Player</th>
                                        <th class="pb-4 font-medium">User ID</th>
                                        <th class="pb-4 font-medium">Reason</th>
                                        <th class="pb-4 font-medium">Banned By</th>
                                        <th class="pb-4 font-medium">Expires</th>
                                        <th class="pb-4 font-medium">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="banTableBody">
                                    <tr>
                                        <td colspan="6" class="text-center py-12" style="color: var(--text-secondary)">
                                            <i class="fas fa-check-circle text-4xl mb-3 opacity-30 text-green-500"></i>
                                            <p>No banned players</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="card rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-6 flex items-center gap-2">
                            <i class="fas fa-gavel text-yellow-500"></i>
                            Quick Ban
                        </h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Player Username or User ID</label>
                                <input type="text" id="quickBanPlayer" class="input-field w-full px-4 py-3 rounded-xl" placeholder="Username or ID">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Target Game</label>
                                <select id="quickBanGame" class="input-field w-full px-4 py-3 rounded-xl">
                                    <option value="all">All Games</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Reason</label>
                                <textarea id="quickBanReason" rows="3" class="input-field w-full px-4 py-3 rounded-xl" placeholder="Ban reason"></textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Duration</label>
                                <select id="quickBanDuration" class="input-field w-full px-4 py-3 rounded-xl">
                                    <option value="3600">1 Hour</option>
                                    <option value="86400">1 Day</option>
                                    <option value="604800">1 Week</option>
                                    <option value="2592000">1 Month</option>
                                    <option value="0">Permanent</option>
                                </select>
                            </div>
                            <button onclick="quickBan()" class="btn-danger w-full py-3.5 rounded-xl text-white font-medium flex items-center justify-center gap-2">
                                <i class="fas fa-ban"></i>Ban Player
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Announcements Section -->
            <section id="section-announcements" class="hidden fade-in">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="card rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-6 flex items-center gap-2">
                            <i class="fas fa-bullhorn text-yellow-500"></i>
                            Send Announcement
                        </h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Target Game</label>
                                <select id="announcementGame" class="input-field w-full px-4 py-3 rounded-xl">
                                    <option value="all">All Games</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Title</label>
                                <input type="text" id="announcementTitle" class="input-field w-full px-4 py-3 rounded-xl" placeholder="Announcement title">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Message</label>
                                <textarea id="announcementMessage" rows="4" class="input-field w-full px-4 py-3 rounded-xl" placeholder="Announcement message"></textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Type</label>
                                <select id="announcementType" class="input-field w-full px-4 py-3 rounded-xl">
                                    <option value="info">ℹ️ Info</option>
                                    <option value="warning">⚠️ Warning</option>
                                    <option value="success">✅ Success</option>
                                    <option value="error">❌ Error</option>
                                </select>
                            </div>
                            <button onclick="sendAnnouncement()" class="btn-primary w-full py-3.5 rounded-xl text-white font-medium flex items-center justify-center gap-2">
                                <i class="fas fa-paper-plane"></i>Send to All Servers
                            </button>
                        </div>
                    </div>

                    <div class="card rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-6 flex items-center gap-2">
                            <i class="fas fa-history text-indigo-400"></i>
                            Announcement History
                        </h3>
                        <div class="space-y-4 max-h-[500px] overflow-y-auto" id="announcementHistory">
                            <div class="text-center py-8" style="color: var(--text-secondary)">
                                <i class="fas fa-bullhorn text-4xl mb-3 opacity-30"></i>
                                <p>No announcements sent yet</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Reports Section -->
            <section id="section-reports" class="hidden fade-in">
                <div class="card rounded-2xl p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-bold flex items-center gap-2">
                            <i class="fas fa-flag text-orange-400"></i>
                            Player Reports
                        </h3>
                        <button onclick="refreshReports()" class="btn-primary px-4 py-2.5 rounded-xl text-white font-medium flex items-center gap-2">
                            <i class="fas fa-sync-alt"></i>Refresh
                        </button>
                    </div>
                    <div class="space-y-4" id="reportsList">
                        <div class="text-center py-12" style="color: var(--text-secondary)">
                            <i class="fas fa-check-circle text-5xl mb-4 opacity-30 text-green-500"></i>
                            <p class="text-lg">No pending reports</p>
                            <p class="text-sm">Reports from players will appear here</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Admin Logs Section -->
            <section id="section-logs" class="hidden fade-in">
                <div class="card rounded-2xl p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-bold flex items-center gap-2">
                            <i class="fas fa-clipboard-list text-indigo-400"></i>
                            Admin Activity Logs
                        </h3>
                        <div class="flex gap-4">
                            <select id="logFilterAdmin" class="input-field px-4 py-2.5 rounded-xl" onchange="filterLogs()">
                                <option value="all">All Admins</option>
                            </select>
                            <select id="logFilterAction" class="input-field px-4 py-2.5 rounded-xl" onchange="filterLogs()">
                                <option value="all">All Actions</option>
                                <option value="login">Login</option>
                                <option value="ban">Ban</option>
                                <option value="unban">Unban</option>
                                <option value="kick">Kick</option>
                                <option value="announcement">Announcement</option>
                                <option value="shutdown">Shutdown</option>
                            </select>
                        </div>
                    </div>
                    <div class="space-y-3 max-h-[600px] overflow-y-auto" id="adminLogsList">
                        <div class="text-center py-12" style="color: var(--text-secondary)">
                            <i class="fas fa-clipboard-list text-5xl mb-4 opacity-30"></i>
                            <p class="text-lg">No logs yet</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Create Admin Section -->
            <section id="section-create-admin" class="hidden fade-in">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="card rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-6 flex items-center gap-2">
                            <i class="fas fa-user-plus text-green-400"></i>
                            Create Admin Account
                        </h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Username</label>
                                <input type="text" id="newAdminUsername" class="input-field w-full px-4 py-3 rounded-xl" placeholder="Admin username">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Password</label>
                                <input type="password" id="newAdminPassword" class="input-field w-full px-4 py-3 rounded-xl" placeholder="Admin password">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Role</label>
                                <select id="newAdminRole" class="input-field w-full px-4 py-3 rounded-xl">
                                    <option value="admin">Admin</option>
                                    <option value="moderator">Moderator</option>
                                </select>
                            </div>
                            <button onclick="createAdmin()" class="btn-primary w-full py-3.5 rounded-xl text-white font-medium flex items-center justify-center gap-2">
                                <i class="fas fa-plus"></i>Create Admin
                            </button>
                        </div>
                    </div>

                    <div class="card rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-6 flex items-center gap-2">
                            <i class="fas fa-users-cog text-indigo-400"></i>
                            Admin List
                        </h3>
                        <div class="space-y-3 max-h-[400px] overflow-y-auto" id="adminList"></div>
                    </div>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="section-settings" class="hidden fade-in">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="card rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-6 flex items-center gap-2">
                            <i class="fas fa-palette text-purple-400"></i>
                            Appearance
                        </h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-4 rounded-xl" style="background: var(--bg-tertiary)">
                                <div class="flex items-center gap-4">
                                    <div class="icon-box bg-indigo-500/20">
                                        <i class="fas fa-moon text-indigo-400"></i>
                                    </div>
                                    <div>
                                        <p class="font-medium">Dark Mode</p>
                                        <p class="text-sm" style="color: var(--text-secondary)">Enable dark theme</p>
                                    </div>
                                </div>
                                <div onclick="toggleTheme()" class="toggle-switch" id="settingsThemeToggle"></div>
                            </div>
                        </div>
                    </div>

                    <div class="card rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-6 flex items-center gap-2">
                            <i class="fas fa-user-circle text-green-400"></i>
                            Profile Settings
                        </h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Username</label>
                                <input type="text" id="profileUsername" class="input-field w-full px-4 py-3 rounded-xl" disabled>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Role</label>
                                <input type="text" id="profileRole" class="input-field w-full px-4 py-3 rounded-xl" disabled>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">New Password</label>
                                <input type="password" id="newPassword" class="input-field w-full px-4 py-3 rounded-xl" placeholder="Enter new password">
                            </div>
                            <button onclick="changePassword()" class="btn-primary w-full py-3.5 rounded-xl text-white font-medium flex items-center justify-center gap-2">
                                <i class="fas fa-key"></i>Change Password
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Lua Script Section -->
            <section id="section-lua-script" class="hidden fade-in">
                <div class="card rounded-2xl p-6">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <i class="fas fa-code text-green-400"></i>
                        Roblox Lua Script
                    </h3>
                    <p class="text-sm mb-6" style="color: var(--text-secondary)">
                        Add this script to your Roblox game (ServerScriptService) to enable panel features
                    </p>
                    
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <span class="font-medium">ServerControl Handler Script</span>
                            <button onclick="copyScript()" class="btn-primary px-4 py-2 rounded-lg text-white text-sm flex items-center gap-2">
                                <i class="fas fa-copy"></i>Copy Script
                            </button>
                        </div>
                        <div class="code-block max-h-[500px] overflow-y-auto" id="luaScript">
<pre style="margin:0; white-space: pre-wrap;">-- ServerControl by BMS STUDIO
-- Place this script in ServerScriptService

local MessagingService = game:GetService("MessagingService")
local DataStoreService = game:GetService("DataStoreService")
local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")

-- DataStores
local BanStore = DataStoreService:GetDataStore("ServerControl_Bans")
local ReportStore = DataStoreService:GetDataStore("ServerControl_Reports")

-- Configuration
local PANEL_TOPIC = "ServerControlPanel"
local SERVER_INFO_TOPIC = "ServerInfo"

-- Server Info
local serverInfo = {
    serverId = game.JobId,
    placeId = game.PlaceId,
    players = {},
    privateOwnerId = game.PrivateServerOwnerId,
    isPrivate = game.PrivateServerId ~= ""
}

-- Update player list
local function updatePlayerList()
    serverInfo.players = {}
    for _, player in ipairs(Players:GetPlayers()) do
        table.insert(serverInfo.players, {
            name = player.Name,
            id = player.UserId,
            joinTime = os.time()
        })
    end
end

-- Check if player is banned
local function checkBan(player)
    local success, banData = pcall(function()
        return BanStore:GetAsync("ban_" .. player.UserId)
    end)
    
    if success and banData then
        if banData.expires == 0 or banData.expires > os.time() then
            player:Kick("You are banned: " .. banData.reason)
            return true
        else
            -- Ban expired, remove it
            pcall(function()
                BanStore:RemoveAsync("ban_" .. player.UserId)
            end)
        end
    end
    return false
end

-- Handle incoming messages from panel
MessagingService:SubscribeAsync(PANEL_TOPIC, function(message)
    local data = message.Data
    
    if data.action == "announcement" then
        -- Show announcement to all players
        for _, player in ipairs(Players:GetPlayers()) do
            -- You can customize how to show announcements
            -- Example: Using a RemoteEvent
            game.ReplicatedStorage:FindFirstChild("AnnouncementEvent"):FireClient(player, data)
        end
        
    elseif data.action == "kick" then
        local player = Players:GetPlayerByUserId(data.userId)
        if player then
            player:Kick(data.reason or "Kicked by admin")
        end
        
    elseif data.action == "ban" then
        -- Save ban to DataStore
        pcall(function()
            BanStore:SetAsync("ban_" .. data.userId, {
                reason = data.reason,
                bannedBy = data.bannedBy,
                expires = data.expires,
                timestamp = os.time()
            })
        end)
        
        -- Kick if in server
        local player = Players:GetPlayerByUserId(data.userId)
        if player then
            player:Kick("Banned: " .. data.reason)
        end
        
    elseif data.action == "unban" then
        pcall(function()
            BanStore:RemoveAsync("ban_" .. data.userId)
        end)
        
    elseif data.action == "shutdown" then
        if data.serverId == game.JobId or data.serverId == "all" then
            for _, player in ipairs(Players:GetPlayers()) do
                player:Kick("Server is shutting down for maintenance")
            end
        end
    end
end)

-- Player events
Players.PlayerAdded:Connect(function(player)
    if not checkBan(player) then
        updatePlayerList()
        -- Send server info update
        pcall(function()
            MessagingService:PublishAsync(SERVER_INFO_TOPIC, serverInfo)
        end)
    end
end)

Players.PlayerRemoving:Connect(function(player)
    updatePlayerList()
    pcall(function()
        MessagingService:PublishAsync(SERVER_INFO_TOPIC, serverInfo)
    end)
end)

-- Report system (call from client)
local function submitReport(reporter, reported, reason)
    local reportId = HttpService:GenerateGUID(false)
    pcall(function()
        ReportStore:SetAsync("report_" .. reportId, {
            id = reportId,
            reporter = {name = reporter.Name, id = reporter.UserId},
            reported = {name = reported.Name, id = reported.UserId},
            reason = reason,
            serverId = game.JobId,
            placeId = game.PlaceId,
            timestamp = os.time(),
            status = "pending"
        })
    end)
end

-- Initial setup
updatePlayerList()
print("[ServerControl] Panel integration loaded successfully!")</pre>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal -->
    <div id="modal" class="modal-backdrop fixed inset-0 flex items-center justify-center z-50 hidden">
        <div class="card rounded-2xl p-6 w-full max-w-lg mx-4 fade-in" id="modalContent"></div>
    </div>

    <!-- Toast -->
    <div id="toast" class="fixed bottom-6 right-6 card rounded-xl px-6 py-4 shadow-2xl transform translate-y-20 opacity-0 transition-all duration-300 z-50 flex items-center gap-3">
        <div id="toastIcon"></div>
        <p id="toastMessage" class="font-medium">Notification</p>
    </div>

    <script>
        // ==================== ROBLOX API CONFIGURATION ====================
        const ROBLOX_API = {
            // Open Cloud API endpoints
            MESSAGING: (universeId) => `https://apis.roblox.com/messaging-service/v1/universes/${universeId}/topics/ServerControlPanel`,
            DATASTORE: (universeId, datastoreName) => `https://apis.roblox.com/datastores/v1/universes/${universeId}/standard-datastores/datastore/entries/entry`,
            DATASTORE_LIST: (universeId, datastoreName) => `https://apis.roblox.com/datastores/v1/universes/${universeId}/standard-datastores/datastore/entries`,
            GAME_INFO: (universeId) => `https://games.roblox.com/v1/games?universeIds=${universeId}`,
            GAME_THUMBNAIL: (universeId) => `https://thumbnails.roblox.com/v1/games/icons?universeIds=${universeId}&size=150x150&format=Png`,
            GAME_SERVERS: (placeId) => `https://games.roblox.com/v1/games/${placeId}/servers/Public?limit=100`,
            USER_INFO: (userId) => `https://users.roblox.com/v1/users/${userId}`,
            USER_BY_NAME: (username) => `https://users.roblox.com/v1/usernames/users`,
            PLACE_TO_UNIVERSE: (placeId) => `https://apis.roblox.com/universes/v1/places/${placeId}/universe`,
            GAME_BY_PLACE: (placeId) => `https://games.roblox.com/v1/games/multiget-place-details?placeIds=${placeId}`,
            
            // Multiple CORS Proxies (fallback)
            PROXIES: [
                'https://api.allorigins.win/raw?url=',
                'https://corsproxy.io/?',
                'https://api.codetabs.com/v1/proxy?quest='
            ],
            currentProxyIndex: 0
        };
        
        // Helper to convert Place ID to Universe ID
        async function placeIdToUniverseId(placeId) {
            try {
                const response = await fetchWithProxy(ROBLOX_API.GAME_BY_PLACE(placeId));
                const text = await response.text();
                const data = JSON.parse(text);
                if (data && data.length > 0) {
                    return data[0].universeId;
                }
                return null;
            } catch (error) {
                console.error('Failed to convert Place ID:', error);
                return null;
            }
        }

        // ==================== DATA STORE ====================
        let currentUser = null;
        let isDarkMode = true;
        
        let admins = JSON.parse(localStorage.getItem('admins')) || [
            { username: 'Adminbmsstudio123', password: 'Adminbmsstudio123', role: 'developer' }
        ];

        let apiKeys = JSON.parse(localStorage.getItem('apiKeys')) || [];
        let games = JSON.parse(localStorage.getItem('games')) || [];
        let bans = JSON.parse(localStorage.getItem('bans')) || [];
        let announcements = JSON.parse(localStorage.getItem('announcements')) || [];
        let reports = JSON.parse(localStorage.getItem('reports')) || [];
        let adminLogs = JSON.parse(localStorage.getItem('adminLogs')) || [];
        let liveServers = [];
        let livePlayers = [];

        // ==================== HELPER FUNCTIONS ====================
        function saveData() {
            localStorage.setItem('admins', JSON.stringify(admins));
            localStorage.setItem('apiKeys', JSON.stringify(apiKeys));
            localStorage.setItem('games', JSON.stringify(games));
            localStorage.setItem('bans', JSON.stringify(bans));
            localStorage.setItem('announcements', JSON.stringify(announcements));
            localStorage.setItem('reports', JSON.stringify(reports));
            localStorage.setItem('adminLogs', JSON.stringify(adminLogs));
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastIcon = document.getElementById('toastIcon');
            const toastMessage = document.getElementById('toastMessage');
            
            toastMessage.textContent = message;
            const icons = {
                success: '<i class="fas fa-check-circle text-2xl text-green-500"></i>',
                error: '<i class="fas fa-times-circle text-2xl text-red-500"></i>',
                warning: '<i class="fas fa-exclamation-triangle text-2xl text-yellow-500"></i>',
                info: '<i class="fas fa-info-circle text-2xl text-blue-500"></i>'
            };
            toastIcon.innerHTML = icons[type] || icons.success;
            
            toast.classList.remove('translate-y-20', 'opacity-0');
            setTimeout(() => toast.classList.add('translate-y-20', 'opacity-0'), 3000);
        }

        function addLog(action, details, gameId = null) {
            const log = {
                id: Date.now(),
                admin: currentUser.username,
                action: action,
                details: details,
                gameId: gameId,
                timestamp: new Date().toLocaleString('id-ID')
            };
            adminLogs.unshift(log);
            if (adminLogs.length > 200) adminLogs.pop();
            saveData();
        }

        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        // ==================== ROBLOX API FUNCTIONS ====================
        async function fetchWithProxy(url, options = {}, proxyIndex = 0) {
            const proxies = ROBLOX_API.PROXIES;
            
            for (let i = proxyIndex; i < proxies.length; i++) {
                try {
                    const proxyUrl = proxies[i] + encodeURIComponent(url);
                    const response = await fetch(proxyUrl, {
                        ...options,
                        headers: {
                            ...options.headers
                        }
                    });
                    
                    if (response.ok) {
                        ROBLOX_API.currentProxyIndex = i;
                        return response;
                    }
                } catch (error) {
                    console.log(`Proxy ${i} failed, trying next...`);
                }
            }
            
            throw new Error('All proxies failed');
        }

        async function fetchGameInfo(universeId, apiKey) {
            try {
                console.log('Fetching game info for Universe ID:', universeId);
                
                // Try to fetch game info
                const response = await fetchWithProxy(ROBLOX_API.GAME_INFO(universeId));
                const text = await response.text();
                
                console.log('Response:', text.substring(0, 200));
                
                let data;
                try {
                    data = JSON.parse(text);
                } catch (e) {
                    console.error('Failed to parse game info response:', e);
                    return null;
                }
                
                if (data.data && data.data.length > 0) {
                    const gameData = data.data[0];
                    console.log('Game found:', gameData.name);
                    
                    // Get thumbnail
                    let thumbnail = '';
                    try {
                        const thumbResponse = await fetchWithProxy(ROBLOX_API.GAME_THUMBNAIL(universeId));
                        const thumbText = await thumbResponse.text();
                        const thumbData = JSON.parse(thumbText);
                        thumbnail = thumbData.data?.[0]?.imageUrl || '';
                    } catch (e) {
                        console.log('Failed to get thumbnail, using placeholder');
                    }
                    
                    return {
                        id: universeId,
                        name: gameData.name,
                        description: gameData.description || '',
                        creator: gameData.creator?.name || 'Unknown',
                        creatorId: gameData.creator?.id || 0,
                        creatorType: gameData.creator?.type || 'User',
                        placeId: gameData.rootPlaceId,
                        playing: gameData.playing || 0,
                        visits: gameData.visits || 0,
                        maxPlayers: gameData.maxPlayers || 50,
                        created: gameData.created,
                        updated: gameData.updated,
                        thumbnail: thumbnail,
                        apiKeyId: apiKey.id
                    };
                }
                
                console.log('No game data in response:', data);
                return null;
            } catch (error) {
                console.error('Failed to fetch game info:', error);
                return null;
            }
        }
        
        // Alternative: Fetch game info using Place ID
        async function fetchGameInfoByPlaceId(placeId, apiKey) {
            try {
                console.log('Fetching game info for Place ID:', placeId);
                
                const response = await fetchWithProxy(ROBLOX_API.GAME_BY_PLACE(placeId));
                const text = await response.text();
                const data = JSON.parse(text);
                
                if (data && data.length > 0) {
                    const gameData = data[0];
                    
                    // Get thumbnail
                    let thumbnail = '';
                    try {
                        const thumbResponse = await fetchWithProxy(ROBLOX_API.GAME_THUMBNAIL(gameData.universeId));
                        const thumbText = await thumbResponse.text();
                        const thumbData = JSON.parse(thumbText);
                        thumbnail = thumbData.data?.[0]?.imageUrl || '';
                    } catch (e) {
                        console.log('Failed to get thumbnail');
                    }
                    
                    return {
                        id: gameData.universeId.toString(),
                        name: gameData.name,
                        description: gameData.description || '',
                        creator: gameData.builder || 'Unknown',
                        creatorId: gameData.builderId || 0,
                        creatorType: 'User',
                        placeId: placeId,
                        playing: gameData.playingCount || 0,
                        visits: gameData.placeVisits || 0,
                        maxPlayers: 50,
                        created: null,
                        updated: null,
                        thumbnail: thumbnail,
                        apiKeyId: apiKey.id
                    };
                }
                return null;
            } catch (error) {
                console.error('Failed to fetch game info by Place ID:', error);
                return null;
            }
        }

        async function fetchGameServers(placeId) {
            try {
                const response = await fetchWithProxy(ROBLOX_API.GAME_SERVERS(placeId));
                const text = await response.text();
                const data = JSON.parse(text);
                return data.data || [];
            } catch (error) {
                console.error('Failed to fetch servers:', error);
                return [];
            }
        }

        async function sendMessageToGame(apiKey, universeId, messageData) {
            // Note: MessagingService requires server-side implementation
            // This simulates the action and logs it
            console.log('Sending message to game:', universeId, messageData);
            
            // Store the action for the Lua script to pick up via DataStore
            const actionId = generateId();
            const action = {
                id: actionId,
                ...messageData,
                timestamp: Date.now()
            };
            
            // Save to local storage for demo
            let pendingActions = JSON.parse(localStorage.getItem('pendingActions') || '[]');
            pendingActions.push({ universeId, action });
            localStorage.setItem('pendingActions', JSON.stringify(pendingActions));
            
            return { success: true, note: 'Action queued. Lua script will execute this.' };
        }

        async function setDataStoreEntry(apiKey, universeId, datastoreName, key, value) {
            // Note: DataStore API requires server-side or proper CORS handling
            console.log('Setting DataStore:', universeId, datastoreName, key, value);
            return true;
        }

        async function getUserInfo(userId) {
            try {
                const response = await fetchWithProxy(ROBLOX_API.USER_INFO(userId));
                const text = await response.text();
                return JSON.parse(text);
            } catch (error) {
                return null;
            }
        }

        async function getUserByUsername(username) {
            try {
                // Use GET endpoint instead of POST for CORS compatibility
                const response = await fetchWithProxy(`https://users.roblox.com/v1/users/search?keyword=${encodeURIComponent(username)}&limit=10`);
                const text = await response.text();
                const data = JSON.parse(text);
                if (data.data && data.data.length > 0) {
                    return data.data.find(u => u.name.toLowerCase() === username.toLowerCase()) || data.data[0];
                }
                return null;
            } catch (error) {
                return null;
            }
        }

        // ==================== LOGIN FUNCTIONS ====================
        function login() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            
            const admin = admins.find(a => a.username === username && a.password === password);
            
            if (admin) {
                currentUser = admin;
                document.getElementById('loginPage').classList.add('hidden');
                document.getElementById('dashboard').classList.remove('hidden');
                
                updateUserUI();
                
                if (admin.role === 'developer') {
                    document.getElementById('createAdminNav').classList.remove('hidden');
                    document.getElementById('createAdminNav').classList.add('flex');
                }
                
                addLog('login', 'Logged into panel');
                initDashboard();
                showToast('Login successful!', 'success');
            } else {
                document.getElementById('loginError').classList.remove('hidden');
                setTimeout(() => document.getElementById('loginError').classList.add('hidden'), 3000);
            }
        }

        function logout() {
            addLog('logout', 'Logged out from panel');
            currentUser = null;
            document.getElementById('dashboard').classList.add('hidden');
            document.getElementById('loginPage').classList.remove('hidden');
            document.getElementById('loginUsername').value = '';
            document.getElementById('loginPassword').value = '';
            showToast('Logged out!', 'info');
        }

        function updateUserUI() {
            const displayName = currentUser.username.length > 15 ? currentUser.username.substring(0, 15) + '...' : currentUser.username;
            document.getElementById('welcomeUser').textContent = displayName;
            document.getElementById('currentUser').textContent = displayName;
            document.getElementById('sidebarUser').textContent = displayName;
            document.getElementById('userAvatar').textContent = currentUser.username.charAt(0).toUpperCase();
            document.getElementById('sidebarAvatar').textContent = currentUser.username.charAt(0).toUpperCase();
            document.getElementById('profileUsername').value = currentUser.username;
            document.getElementById('profileRole').value = currentUser.role.charAt(0).toUpperCase() + currentUser.role.slice(1);
            document.getElementById('currentRole').textContent = currentUser.role.charAt(0).toUpperCase() + currentUser.role.slice(1);
            document.getElementById('sidebarRole').textContent = currentUser.role.charAt(0).toUpperCase() + currentUser.role.slice(1);
        }

        // ==================== THEME ====================
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('light-theme');
            document.getElementById('themeToggle').classList.toggle('active');
            document.getElementById('settingsThemeToggle')?.classList.toggle('active');
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
        }

        // ==================== NAVIGATION ====================
        function showSection(section) {
            document.querySelectorAll('main > section').forEach(s => s.classList.add('hidden'));
            document.getElementById('section-' + section)?.classList.remove('hidden');
            
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            document.querySelector(`[data-section="${section}"]`)?.classList.add('active');
            
            const titles = {
                'dashboard-main': 'Dashboard',
                'api-keys': 'Roblox API Keys',
                'games': 'My Games',
                'servers': 'Live Servers',
                'players': 'Players',
                'bans': 'Ban System',
                'announcements': 'Announcements',
                'reports': 'Player Reports',
                'logs': 'Admin Logs',
                'create-admin': 'Create Admin',
                'settings': 'Settings',
                'lua-script': 'Lua Script'
            };
            document.getElementById('sectionTitle').textContent = titles[section] || 'Dashboard';
        }

        // ==================== INITIALIZE DASHBOARD ====================
        async function initDashboard() {
            updateStats();
            renderApiKeys();
            renderGames();
            renderBans();
            renderAnnouncements();
            renderReports();
            renderLogs();
            renderAdminList();
            populateGameSelects();
            await refreshAllData();
        }

        async function refreshAllData() {
            showToast('Refreshing data...', 'info');
            
            // Refresh game info for each API key
            for (const apiKey of apiKeys) {
                if (apiKey.universeId) {
                    const gameInfo = await fetchGameInfo(apiKey.universeId, apiKey);
                    if (gameInfo) {
                        const existingIndex = games.findIndex(g => g.id === gameInfo.id);
                        if (existingIndex >= 0) {
                            games[existingIndex] = gameInfo;
                        } else {
                            games.push(gameInfo);
                        }
                    }
                }
            }
            
            // Fetch live servers
            liveServers = [];
            for (const game of games) {
                if (game.placeId) {
                    const servers = await fetchGameServers(game.placeId);
                    servers.forEach(server => {
                        liveServers.push({
                            ...server,
                            gameId: game.id,
                            gameName: game.name
                        });
                    });
                }
            }
            
            saveData();
            updateStats();
            renderDashboardGames();
            renderGames();
            renderServers();
            showToast('Data refreshed!', 'success');
        }

        function updateStats() {
            document.getElementById('totalGames').textContent = games.length;
            document.getElementById('totalServers').textContent = liveServers.length;
            
            const totalPlayers = games.reduce((sum, g) => sum + (g.playing || 0), 0);
            document.getElementById('totalPlayers').textContent = totalPlayers.toLocaleString();
            document.getElementById('totalBans').textContent = bans.length;
            document.getElementById('reportBadge').textContent = reports.filter(r => r.status === 'pending').length;
            document.getElementById('apiKeyCount').textContent = apiKeys.length;
        }

        // ==================== API KEY MANAGEMENT ====================
        function showAddApiKeyModal() {
            const modal = document.getElementById('modal');
            const content = document.getElementById('modalContent');
            
            content.innerHTML = `
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold flex items-center gap-2">
                        <i class="fas fa-key text-yellow-500"></i>
                        Add Roblox Game
                    </h3>
                    <button onclick="closeModal()" class="w-8 h-8 rounded-lg flex items-center justify-center hover:bg-gray-700/50 transition-colors">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <!-- Tabs -->
                <div class="flex gap-2 mb-6">
                    <button onclick="switchApiTab('auto')" class="tab-btn active" id="tabAuto">
                        <i class="fas fa-magic mr-2"></i>Auto Detect
                    </button>
                    <button onclick="switchApiTab('manual')" class="tab-btn" id="tabManual">
                        <i class="fas fa-edit mr-2"></i>Manual Input
                    </button>
                </div>
                
                <!-- Auto Detect Tab -->
                <div id="apiTabAuto" class="space-y-4">
                    <div class="p-4 rounded-xl bg-blue-500/10 border border-blue-500/30">
                        <p class="text-sm text-blue-400">
                            <i class="fas fa-info-circle mr-2"></i>
                            Enter your Universe ID or Place ID to auto-fetch game information.
                        </p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Universe ID or Place ID</label>
                        <div class="flex gap-2">
                            <input type="text" id="apiUniverseId" class="input-field flex-1 px-4 py-3 rounded-xl" placeholder="e.g., 1234567890">
                            <select id="apiIdType" class="input-field px-3 py-3 rounded-xl">
                                <option value="universe">Universe ID</option>
                                <option value="place">Place ID</option>
                            </select>
                        </div>
                        <p class="text-xs mt-1" style="color: var(--text-secondary)">
                            <strong>Place ID:</strong> From game URL (roblox.com/games/<strong>123456</strong>/...) <br>
                            <strong>Universe ID:</strong> From Roblox Studio → Game Settings → Basic Info
                        </p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">API Key (for sending commands)</label>
                        <textarea id="apiKeyValue" rows="2" class="input-field w-full px-4 py-3 rounded-xl font-mono text-sm" placeholder="Optional - Get from create.roblox.com/credentials"></textarea>
                    </div>
                    <button onclick="addApiKeyAuto()" class="btn-primary w-full py-3.5 rounded-xl text-white font-medium flex items-center justify-center gap-2" id="fetchGameBtn">
                        <i class="fas fa-search"></i>Fetch Game Info
                    </button>
                    <div id="fetchStatus" class="hidden text-center py-2">
                        <div class="loading-spinner mx-auto mb-2"></div>
                        <p class="text-sm" style="color: var(--text-secondary)">Connecting to Roblox...</p>
                    </div>
                </div>
                
                <!-- Manual Input Tab -->
                <div id="apiTabManual" class="space-y-4 hidden">
                    <div class="p-4 rounded-xl bg-yellow-500/10 border border-yellow-500/30">
                        <p class="text-sm text-yellow-400">
                            <i class="fas fa-exclamation-triangle mr-2"></i>
                            Use this if auto-detect fails. Enter game details manually.
                        </p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Game Name</label>
                        <input type="text" id="manualGameName" class="input-field w-full px-4 py-3 rounded-xl" placeholder="My Awesome Game">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Universe ID</label>
                            <input type="text" id="manualUniverseId" class="input-field w-full px-4 py-3 rounded-xl" placeholder="1234567890">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Place ID</label>
                            <input type="text" id="manualPlaceId" class="input-field w-full px-4 py-3 rounded-xl" placeholder="1234567890">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">Creator Name</label>
                        <input type="text" id="manualCreator" class="input-field w-full px-4 py-3 rounded-xl" placeholder="Your username or group name">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary)">API Key (optional)</label>
                        <textarea id="manualApiKey" rows="2" class="input-field w-full px-4 py-3 rounded-xl font-mono text-sm" placeholder="Get from create.roblox.com/credentials"></textarea>
                    </div>
                    <button onclick="addApiKeyManual()" class="btn-primary w-full py-3.5 rounded-xl text-white font-medium flex items-center justify-center gap-2">
                        <i class="fas fa-plus"></i>Add Game
                    </button>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }
        
        function switchApiTab(tab) {
            document.getElementById('tabAuto').classList.toggle('active', tab === 'auto');
            document.getElementById('tabManual').classList.toggle('active', tab === 'manual');
            document.getElementById('apiTabAuto').classList.toggle('hidden', tab !== 'auto');
            document.getElementById('apiTabManual').classList.toggle('hidden', tab !== 'manual');
        }

        async function addApiKeyAuto() {
            let inputId = document.getElementById('apiUniverseId').value.trim();
            const idType = document.getElementById('apiIdType').value;
            const apiKey = document.getElementById('apiKeyValue').value.trim();
            
            if (!inputId) {
                showToast('Please enter Universe ID or Place ID!', 'error');
                return;
            }
            
            // Show loading state
            document.getElementById('fetchGameBtn').classList.add('hidden');
            document.getElementById('fetchStatus').classList.remove('hidden');
            
            let universeId = inputId;
            
            // If Place ID, convert to Universe ID
            if (idType === 'place') {
                showToast('Converting Place ID to Universe ID...', 'info');
                const converted = await placeIdToUniverseId(inputId);
                if (converted) {
                    universeId = converted.toString();
                    showToast(`Found Universe ID: ${universeId}`, 'info');
                } else {
                    showToast('Could not convert Place ID. Trying as Universe ID...', 'warning');
                }
            }
            
            showToast('Fetching game info from Roblox...', 'info');
            
            const newApiKey = {
                id: generateId(),
                name: 'Loading...',
                universeId: universeId,
                placeId: idType === 'place' ? inputId : '',
                apiKey: apiKey || '',
                status: 'pending',
                createdAt: new Date().toLocaleString('id-ID')
            };
            
            // Try to fetch game info (try Universe ID first, then Place ID)
            let gameInfo = await fetchGameInfo(universeId, newApiKey);
            
            // If Universe ID failed and we have original Place ID, try that
            if (!gameInfo && idType === 'place') {
                console.log('Trying Place ID method...');
                gameInfo = await fetchGameInfoByPlaceId(inputId, newApiKey);
                if (gameInfo) {
                    universeId = gameInfo.id;
                    newApiKey.universeId = universeId;
                }
            }
            
            // Reset button state
            document.getElementById('fetchGameBtn').classList.remove('hidden');
            document.getElementById('fetchStatus').classList.add('hidden');
            
            if (gameInfo) {
                newApiKey.name = gameInfo.name;
                newApiKey.status = 'connected';
                apiKeys.push(newApiKey);
                games.push(gameInfo);
                saveData();
                
                renderApiKeys();
                renderGames();
                renderDashboardGames();
                updateStats();
                populateGameSelects();
                closeModal();
                
                showToast(`Connected to "${gameInfo.name}"!`, 'success');
                addLog('api_key', `Added game: ${gameInfo.name} (Universe: ${universeId})`, universeId);
            } else {
                // Offer to switch to manual
                showToast('Auto-detect failed. Try Manual Input or check your ID.', 'warning');
                switchApiTab('manual');
                document.getElementById('manualUniverseId').value = universeId;
                if (idType === 'place') {
                    document.getElementById('manualPlaceId').value = inputId;
                }
                document.getElementById('manualApiKey').value = apiKey;
            }
        }
        
        function addApiKeyManual() {
            const gameName = document.getElementById('manualGameName').value.trim();
            const universeId = document.getElementById('manualUniverseId').value.trim();
            const placeId = document.getElementById('manualPlaceId').value.trim();
            const creator = document.getElementById('manualCreator').value.trim();
            const apiKey = document.getElementById('manualApiKey').value.trim();
            
            if (!gameName || !universeId || !placeId || !creator) {
                showToast('Please fill all required fields!', 'error');
                return;
            }
            
            const newApiKey = {
                id: generateId(),
                name: gameName,
                universeId: universeId,
                apiKey: apiKey || '',
                status: apiKey ? 'connected' : 'limited',
                createdAt: new Date().toLocaleString('id-ID')
            };
            
            const gameInfo = {
                id: universeId,
                name: gameName,
                description: '',
                creator: creator,
                creatorId: 0,
                creatorType: 'User',
                placeId: placeId,
                playing: 0,
                visits: 0,
                maxPlayers: 50,
                created: new Date().toISOString(),
                updated: new Date().toISOString(),
                thumbnail: '',
                apiKeyId: newApiKey.id
            };
            
            apiKeys.push(newApiKey);
            games.push(gameInfo);
            saveData();
            
            renderApiKeys();
            renderGames();
            renderDashboardGames();
            updateStats();
            populateGameSelects();
            closeModal();
            
            showToast(`Game "${gameName}" added!`, 'success');
            addLog('api_key', `Manually added game: ${gameName}`, universeId);
        }

        function renderApiKeys() {
            const container = document.getElementById('apiKeyGrid');
            
            if (apiKeys.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12 col-span-full" style="color: var(--text-secondary)">
                        <i class="fas fa-gamepad text-5xl mb-4 opacity-30"></i>
                        <p class="text-lg">No games connected</p>
                        <p class="text-sm">Add your Roblox game to start managing servers</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = apiKeys.map(key => {
                const game = games.find(g => g.id === key.universeId);
                const statusConfig = {
                    connected: { bg: 'api-status-connected', text: 'Connected', icon: 'fa-check-circle' },
                    limited: { bg: 'api-status-pending', text: 'Limited', icon: 'fa-exclamation-circle' },
                    error: { bg: 'api-status-error', text: 'Error', icon: 'fa-times-circle' },
                    pending: { bg: 'api-status-pending', text: 'Pending', icon: 'fa-clock' }
                };
                const status = statusConfig[key.status] || statusConfig.pending;
                
                return `
                    <div class="card rounded-2xl p-5 hover:border-indigo-500 transition-all">
                        <div class="flex items-start gap-4 mb-4">
                            ${game?.thumbnail ? 
                                `<img src="${game.thumbnail}" class="game-thumbnail" alt="${game.name}" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="game-thumbnail items-center justify-center hidden"><i class="fas fa-gamepad text-2xl" style="color: var(--text-secondary)"></i></div>` :
                                `<div class="game-thumbnail flex items-center justify-center bg-gradient-to-br from-indigo-500/20 to-purple-500/20"><i class="fas fa-gamepad text-2xl text-indigo-400"></i></div>`
                            }
                            <div class="flex-1 min-w-0">
                                <h4 class="font-bold truncate">${game?.name || key.name}</h4>
                                <p class="text-sm truncate" style="color: var(--text-secondary)">
                                    <i class="fas fa-user-circle mr-1"></i>${game?.creator || 'Unknown Creator'}
                                </p>
                                <p class="text-xs mt-1 font-mono" style="color: var(--text-secondary)">
                                    Universe: ${key.universeId}
                                </p>
                            </div>
                        </div>
                        
                        <div class="flex items-center gap-2 mb-4">
                            <span class="badge ${status.bg} text-white flex items-center gap-1">
                                <i class="fas ${status.icon} text-xs"></i>
                                ${status.text}
                            </span>
                            ${key.apiKey ? 
                                '<span class="badge bg-green-500/20 text-green-400"><i class="fas fa-key mr-1"></i>API Key Set</span>' : 
                                '<span class="badge bg-gray-500/20 text-gray-400"><i class="fas fa-key mr-1"></i>No API Key</span>'
                            }
                        </div>
                        
                        ${game ? `
                        <div class="grid grid-cols-3 gap-2 mb-4 text-center">
                            <div class="p-2 rounded-lg" style="background: var(--bg-tertiary)">
                                <p class="text-lg font-bold text-green-400">${(game.playing || 0).toLocaleString()}</p>
                                <p class="text-xs" style="color: var(--text-secondary)">Playing</p>
                            </div>
                            <div class="p-2 rounded-lg" style="background: var(--bg-tertiary)">
                                <p class="text-lg font-bold">${formatNumber(game.visits || 0)}</p>
                                <p class="text-xs" style="color: var(--text-secondary)">Visits</p>
                            </div>
                            <div class="p-2 rounded-lg" style="background: var(--bg-tertiary)">
                                <p class="text-lg font-bold">${game.maxPlayers || 0}</p>
                                <p class="text-xs" style="color: var(--text-secondary)">Max</p>
                            </div>
                        </div>
                        
                        <div class="text-sm mb-4 p-3 rounded-lg" style="background: var(--bg-tertiary)">
                            <div class="flex items-center justify-between">
                                <span style="color: var(--text-secondary)"><i class="fas fa-globe mr-2"></i>Place ID:</span>
                                <span class="font-mono text-xs">${game.placeId || 'N/A'}</span>
                            </div>
                        </div>
                        ` : ''}
                        
                        <div class="flex gap-2">
                            <button onclick="refreshGameData('${key.id}')" class="flex-1 btn-primary py-2.5 rounded-xl text-white text-sm font-medium flex items-center justify-center gap-2">
                                <i class="fas fa-sync-alt"></i>Refresh
                            </button>
                            <a href="https://www.roblox.com/games/${game?.placeId || ''}" target="_blank" class="btn-secondary py-2.5 px-4 rounded-xl text-sm font-medium flex items-center justify-center">
                                <i class="fas fa-external-link-alt"></i>
                            </a>
                            <button onclick="deleteApiKey('${key.id}')" class="btn-danger py-2.5 px-4 rounded-xl text-white text-sm font-medium">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function formatNumber(num) {
            if (num >= 1e9) return (num / 1e9).toFixed(1) + 'B';
            if (num >= 1e6) return (num / 1e6).toFixed(1) + 'M';
            if (num >= 1e3) return (num / 1e3).toFixed(1) + 'K';
            return num.toString();
        }

        async function refreshGameData(apiKeyId) {
            const apiKey = apiKeys.find(k => k.id === apiKeyId);
            if (!apiKey) return;
            
            showToast('Refreshing game data...', 'info');
            const gameInfo = await fetchGameInfo(apiKey.universeId, apiKey);
            
            if (gameInfo) {
                const existingIndex = games.findIndex(g => g.id === gameInfo.id);
                if (existingIndex >= 0) {
                    games[existingIndex] = gameInfo;
                } else {
                    games.push(gameInfo);
                }
                apiKey.status = 'connected';
                saveData();
                renderApiKeys();
                renderGames();
                updateStats();
                showToast('Game data updated!', 'success');
            } else {
                apiKey.status = 'error';
                saveData();
                renderApiKeys();
                showToast('Failed to refresh game data', 'error');
            }
        }

        function deleteApiKey(apiKeyId) {
            const apiKey = apiKeys.find(k => k.id === apiKeyId);
            if (confirm(`Delete API Key "${apiKey.name}"? This will remove the game from the panel.`)) {
                games = games.filter(g => g.apiKeyId !== apiKeyId);
                apiKeys = apiKeys.filter(k => k.id !== apiKeyId);
                saveData();
                renderApiKeys();
                renderGames();
                renderDashboardGames();
                updateStats();
                populateGameSelects();
                showToast('API Key deleted!', 'success');
                addLog('delete', `Deleted API Key: ${apiKey.name}`);
            }
        }

        // ==================== GAMES ====================
        function renderDashboardGames() {
            const container = document.getElementById('dashboardGames');
            
            if (games.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8" style="color: var(--text-secondary)">
                        <i class="fas fa-plug text-4xl mb-3 opacity-30"></i>
                        <p>No games connected</p>
                        <p class="text-sm">Add your Roblox API Key to get started</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = games.slice(0, 4).map(game => `
                <div class="flex items-center gap-4 p-4 rounded-xl hover:scale-[1.02] transition-all cursor-pointer" style="background: var(--bg-tertiary)" onclick="showSection('games')">
                    ${game.thumbnail ? 
                        `<img src="${game.thumbnail}" class="w-12 h-12 rounded-lg object-cover">` :
                        `<div class="w-12 h-12 rounded-lg bg-indigo-500/20 flex items-center justify-center"><i class="fas fa-gamepad text-indigo-400"></i></div>`
                    }
                    <div class="flex-1 min-w-0">
                        <p class="font-medium truncate">${game.name}</p>
                        <p class="text-sm" style="color: var(--text-secondary)">By ${game.creator}</p>
                    </div>
                    <div class="text-right">
                        <p class="font-bold text-green-500">${(game.playing || 0).toLocaleString()}</p>
                        <p class="text-xs" style="color: var(--text-secondary)">playing</p>
                    </div>
                </div>
            `).join('');
        }

        function renderGames() {
            const container = document.getElementById('gamesGrid');
            
            if (games.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12 col-span-full" style="color: var(--text-secondary)">
                        <i class="fas fa-gamepad text-5xl mb-4 opacity-30"></i>
                        <p class="text-lg">No games connected</p>
                        <p class="text-sm">Add your API Key first</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = games.map(game => `
                <div class="card server-card rounded-2xl overflow-hidden">
                    <div class="h-32 bg-gradient-to-br from-indigo-500/20 to-purple-500/20 flex items-center justify-center">
                        ${game.thumbnail ? 
                            `<img src="${game.thumbnail}" class="w-full h-full object-cover">` :
                            `<i class="fas fa-gamepad text-5xl" style="color: var(--text-secondary)"></i>`
                        }
                    </div>
                    <div class="p-5">
                        <h3 class="text-lg font-bold mb-2 truncate">${game.name}</h3>
                        <div class="space-y-2 mb-4">
                            <div class="flex items-center gap-2 text-sm">
                                <i class="fas fa-user w-4" style="color: var(--text-secondary)"></i>
                                <span>Creator:</span>
                                <span class="font-medium">${game.creator}</span>
                            </div>
                            <div class="flex items-center gap-2 text-sm">
                                <i class="fas fa-id-badge w-4" style="color: var(--text-secondary)"></i>
                                <span>Universe ID:</span>
                                <span class="font-mono text-xs">${game.id}</span>
                            </div>
                            <div class="flex items-center gap-2 text-sm">
                                <i class="fas fa-globe w-4" style="color: var(--text-secondary)"></i>
                                <span>Place ID:</span>
                                <span class="font-mono text-xs">${game.placeId}</span>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-3 gap-2 mb-4 text-center">
                            <div class="p-2 rounded-lg" style="background: var(--bg-tertiary)">
                                <p class="text-lg font-bold text-green-500">${(game.playing || 0).toLocaleString()}</p>
                                <p class="text-xs" style="color: var(--text-secondary)">Playing</p>
                            </div>
                            <div class="p-2 rounded-lg" style="background: var(--bg-tertiary)">
                                <p class="text-lg font-bold">${formatNumber(game.visits || 0)}</p>
                                <p class="text-xs" style="color: var(--text-secondary)">Visits</p>
                            </div>
                            <div class="p-2 rounded-lg" style="background: var(--bg-tertiary)">
                                <p class="text-lg font-bold">${game.maxPlayers || 0}</p>
                                <p class="text-xs" style="color: var(--text-secondary)">Max</p>
                            </div>
                        </div>
                        
                        <div class="flex gap-2">
                            <button onclick="showGameServers('${game.id}')" class="flex-1 btn-primary py-2.5 rounded-xl text-white text-sm font-medium flex items-center justify-center gap-2">
                                <i class="fas fa-server"></i>Servers
                            </button>
                            <a href="https://www.roblox.com/games/${game.placeId}" target="_blank" class="btn-secondary py-2.5 px-4 rounded-xl text-sm font-medium flex items-center justify-center">
                                <i class="fas fa-external-link-alt"></i>
                            </a>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        async function showGameServers(gameId) {
            const game = games.find(g => g.id === gameId);
            if (!game) return;
            
            showSection('servers');
            document.getElementById('serverGameFilter').value = gameId;
            filterServersByGame();
        }

        // ==================== SERVERS ====================
        function renderServers() {
            const container = document.getElementById('serverTableBody');
            
            if (liveServers.length === 0) {
                container.innerHTML = `
                    <tr>
                        <td colspan="6" class="text-center py-12" style="color: var(--text-secondary)">
                            <i class="fas fa-server text-4xl mb-3 opacity-30"></i>
                            <p>No active servers</p>
                            <p class="text-sm">Servers will appear when players join your game</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            container.innerHTML = liveServers.map(server => `
                <tr class="table-row border-b border-gray-700/30">
                    <td class="py-4">
                        <span class="font-mono text-sm">${server.id?.substring(0, 8) || 'Unknown'}...</span>
                    </td>
                    <td class="py-4">${server.gameName || 'Unknown'}</td>
                    <td class="py-4">
                        <span class="font-bold">${server.playing || 0}</span>
                        <span style="color: var(--text-secondary)">/ ${server.maxPlayers || 50}</span>
                    </td>
                    <td class="py-4">
                        ${server.playerTokens ? 
                            '<span class="badge bg-purple-500/20 text-purple-400">Private</span>' : 
                            '<span class="badge bg-blue-500/20 text-blue-400">Public</span>'
                        }
                    </td>
                    <td class="py-4" style="color: var(--text-secondary)">${server.ownerUserId || '-'}</td>
                    <td class="py-4">
                        <div class="flex gap-2">
                            <button onclick="shutdownServer('${server.gameId}', '${server.id}')" class="btn-danger px-3 py-1.5 rounded-lg text-white text-sm flex items-center gap-1">
                                <i class="fas fa-power-off text-xs"></i>Shutdown
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function populateGameSelects() {
            const selects = ['serverGameFilter', 'playerGameFilter', 'announcementGame', 'quickBanGame'];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    const currentValue = select.value;
                    select.innerHTML = '<option value="all">All Games</option>' + 
                        games.map(g => `<option value="${g.id}">${g.name}</option>`).join('');
                    select.value = currentValue || 'all';
                }
            });
        }

        function filterServersByGame() {
            const gameId = document.getElementById('serverGameFilter').value;
            const filtered = gameId === 'all' ? liveServers : liveServers.filter(s => s.gameId === gameId);
            
            const container = document.getElementById('serverTableBody');
            if (filtered.length === 0) {
                container.innerHTML = `
                    <tr>
                        <td colspan="6" class="text-center py-12" style="color: var(--text-secondary)">
                            <i class="fas fa-server text-4xl mb-3 opacity-30"></i>
                            <p>No servers found</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            container.innerHTML = filtered.map(server => `
                <tr class="table-row border-b border-gray-700/30">
                    <td class="py-4">
                        <span class="font-mono text-sm">${server.id?.substring(0, 8) || 'Unknown'}...</span>
                    </td>
                    <td class="py-4">${server.gameName || 'Unknown'}</td>
                    <td class="py-4">
                        <span class="font-bold">${server.playing || 0}</span>
                        <span style="color: var(--text-secondary)">/ ${server.maxPlayers || 50}</span>
                    </td>
                    <td class="py-4">
                        ${server.playerTokens ? 
                            '<span class="badge bg-purple-500/20 text-purple-400">Private</span>' : 
                            '<span class="badge bg-blue-500/20 text-blue-400">Public</span>'
                        }
                    </td>
                    <td class="py-4" style="color: var(--text-secondary)">${server.ownerUserId || '-'}</td>
                    <td class="py-4">
                        <div class="flex gap-2">
                            <button onclick="shutdownServer('${server.gameId}', '${server.id}')" class="btn-danger px-3 py-1.5 rounded-lg text-white text-sm flex items-center gap-1">
                                <i class="fas fa-power-off text-xs"></i>Shutdown
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        async function shutdownServer(gameId, serverId) {
            if (!confirm('Shutdown this server? All players will be disconnected.')) return;
            
            const game = games.find(g => g.id === gameId);
            const apiKey = apiKeys.find(k => k.universeId === gameId);
            
            if (!apiKey) {
                showToast('API Key not found!', 'error');
                return;
            }
            
            showToast('Sending shutdown command...', 'info');
            
            const result = await sendMessageToGame(apiKey.apiKey, gameId, {
                action: 'shutdown',
                serverId: serverId
            });
            
            if (result.success) {
                showToast('Shutdown command sent!', 'success');
                addLog('shutdown', `Shutdown server ${serverId.substring(0, 8)}...`, gameId);
            } else {
                showToast('Failed to send shutdown command: ' + (result.error || 'Unknown error'), 'error');
            }
        }

        async function shutdownAllServers() {
            if (!confirm('Shutdown ALL servers? This will disconnect all players from all games!')) return;
            
            showToast('Sending shutdown commands...', 'info');
            
            for (const apiKey of apiKeys) {
                await sendMessageToGame(apiKey.apiKey, apiKey.universeId, {
                    action: 'shutdown',
                    serverId: 'all'
                });
            }
            
            showToast('Shutdown commands sent to all games!', 'success');
            addLog('shutdown', 'Shutdown all servers');
        }

        async function refreshAllServers() {
            await refreshAllData();
        }

        // ==================== BAN SYSTEM ====================
        function renderBans() {
            const container = document.getElementById('banTableBody');
            
            if (bans.length === 0) {
                container.innerHTML = `
                    <tr>
                        <td colspan="6" class="text-center py-12" style="color: var(--text-secondary)">
                            <i class="fas fa-check-circle text-4xl mb-3 opacity-30 text-green-500"></i>
                            <p>No banned players</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            container.innerHTML = bans.map(ban => `
                <tr class="table-row border-b border-gray-700/30">
                    <td class="py-4 font-medium">${ban.playerName}</td>
                    <td class="py-4 font-mono text-sm">${ban.userId}</td>
                    <td class="py-4" style="color: var(--text-secondary)">${ban.reason}</td>
                    <td class="py-4">${ban.bannedBy}</td>
                    <td class="py-4">
                        <span class="badge ${ban.expires === 0 ? 'bg-red-500' : 'bg-yellow-500'} text-white">
                            ${ban.expires === 0 ? 'Permanent' : new Date(ban.expires * 1000).toLocaleDateString()}
                        </span>
                    </td>
                    <td class="py-4">
                        <button onclick="unbanPlayer('${ban.id}')" class="btn-success px-3 py-1.5 rounded-lg text-white text-sm flex items-center gap-1">
                            <i class="fas fa-user-check text-xs"></i>Unban
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        async function quickBan() {
            const playerInput = document.getElementById('quickBanPlayer').value;
            const gameId = document.getElementById('quickBanGame').value;
            const reason = document.getElementById('quickBanReason').value;
            const duration = parseInt(document.getElementById('quickBanDuration').value);
            
            if (!playerInput || !reason) {
                showToast('Please fill player and reason!', 'error');
                return;
            }
            
            showToast('Processing ban...', 'info');
            
            // Try to get user info
            let userInfo;
            if (isNaN(parseInt(playerInput))) {
                userInfo = await getUserByUsername(playerInput);
            } else {
                userInfo = await getUserInfo(playerInput);
            }
            
            if (!userInfo) {
                showToast('Player not found!', 'error');
                return;
            }
            
            const expires = duration === 0 ? 0 : Math.floor(Date.now() / 1000) + duration;
            
            const ban = {
                id: generateId(),
                userId: userInfo.id,
                playerName: userInfo.name,
                reason: reason,
                bannedBy: currentUser.username,
                expires: expires,
                gameId: gameId,
                timestamp: Date.now()
            };
            
            bans.push(ban);
            saveData();
            
            // Send ban to game(s)
            const targetApiKeys = gameId === 'all' ? apiKeys : apiKeys.filter(k => k.universeId === gameId);
            
            for (const apiKey of targetApiKeys) {
                await sendMessageToGame(apiKey.apiKey, apiKey.universeId, {
                    action: 'ban',
                    userId: userInfo.id,
                    reason: reason,
                    bannedBy: currentUser.username,
                    expires: expires
                });
            }
            
            renderBans();
            updateStats();
            
            document.getElementById('quickBanPlayer').value = '';
            document.getElementById('quickBanReason').value = '';
            
            showToast(`${userInfo.name} has been banned!`, 'success');
            addLog('ban', `Banned ${userInfo.name} (${userInfo.id}): ${reason}`, gameId);
        }

        async function unbanPlayer(banId) {
            const ban = bans.find(b => b.id === banId);
            if (!confirm(`Unban ${ban.playerName}?`)) return;
            
            // Send unban to game(s)
            const targetApiKeys = ban.gameId === 'all' ? apiKeys : apiKeys.filter(k => k.universeId === ban.gameId);
            
            for (const apiKey of targetApiKeys) {
                await sendMessageToGame(apiKey.apiKey, apiKey.universeId, {
                    action: 'unban',
                    userId: ban.userId
                });
            }
            
            bans = bans.filter(b => b.id !== banId);
            saveData();
            renderBans();
            updateStats();
            
            showToast(`${ban.playerName} has been unbanned!`, 'success');
            addLog('unban', `Unbanned ${ban.playerName} (${ban.userId})`, ban.gameId);
        }

        // ==================== ANNOUNCEMENTS ====================
        async function sendAnnouncement() {
            const gameId = document.getElementById('announcementGame').value;
            const title = document.getElementById('announcementTitle').value;
            const message = document.getElementById('announcementMessage').value;
            const type = document.getElementById('announcementType').value;
            
            if (!title || !message) {
                showToast('Please fill title and message!', 'error');
                return;
            }
            
            showToast('Sending announcement...', 'info');
            
            const announcement = {
                id: generateId(),
                title: title,
                message: message,
                type: type,
                gameId: gameId,
                sentBy: currentUser.username,
                timestamp: Date.now()
            };
            
            // Send to game(s)
            const targetApiKeys = gameId === 'all' ? apiKeys : apiKeys.filter(k => k.universeId === gameId);
            
            let successCount = 0;
            for (const apiKey of targetApiKeys) {
                const result = await sendMessageToGame(apiKey.apiKey, apiKey.universeId, {
                    action: 'announcement',
                    title: title,
                    message: message,
                    type: type
                });
                if (result.success) successCount++;
            }
            
            announcements.unshift(announcement);
            saveData();
            renderAnnouncements();
            
            document.getElementById('announcementTitle').value = '';
            document.getElementById('announcementMessage').value = '';
            
            if (successCount > 0) {
                showToast(`Announcement sent to ${successCount} game(s)!`, 'success');
                addLog('announcement', `Sent announcement: ${title}`, gameId);
            } else {
                showToast('Failed to send announcement. Check API permissions.', 'error');
            }
        }

        function renderAnnouncements() {
            const container = document.getElementById('announcementHistory');
            
            if (announcements.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8" style="color: var(--text-secondary)">
                        <i class="fas fa-bullhorn text-4xl mb-3 opacity-30"></i>
                        <p>No announcements sent yet</p>
                    </div>
                `;
                return;
            }
            
            const typeConfig = {
                info: { bg: 'bg-blue-500/20', text: 'text-blue-400', icon: 'fa-info-circle' },
                warning: { bg: 'bg-yellow-500/20', text: 'text-yellow-400', icon: 'fa-exclamation-triangle' },
                success: { bg: 'bg-green-500/20', text: 'text-green-400', icon: 'fa-check-circle' },
                error: { bg: 'bg-red-500/20', text: 'text-red-400', icon: 'fa-times-circle' }
            };
            
            container.innerHTML = announcements.slice(0, 20).map(ann => {
                const config = typeConfig[ann.type] || typeConfig.info;
                const game = games.find(g => g.id === ann.gameId);
                return `
                    <div class="p-4 rounded-xl" style="background: var(--bg-tertiary)">
                        <div class="flex items-center justify-between mb-2">
                            <span class="badge ${config.bg} ${config.text} flex items-center gap-1">
                                <i class="fas ${config.icon} text-xs"></i>${ann.type.toUpperCase()}
                            </span>
                            <span class="text-xs" style="color: var(--text-secondary)">${new Date(ann.timestamp).toLocaleString()}</span>
                        </div>
                        <h4 class="font-bold mb-1">${ann.title}</h4>
                        <p class="text-sm" style="color: var(--text-secondary)">${ann.message}</p>
                        <p class="text-xs mt-2" style="color: var(--text-secondary)">
                            <i class="fas fa-gamepad mr-1"></i>${game?.name || 'All Games'} 
                            <i class="fas fa-user ml-2 mr-1"></i>${ann.sentBy}
                        </p>
                    </div>
                `;
            }).join('');
        }

        // ==================== REPORTS ====================
        function renderReports() {
            const container = document.getElementById('reportsList');
            
            if (reports.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12" style="color: var(--text-secondary)">
                        <i class="fas fa-check-circle text-5xl mb-4 opacity-30 text-green-500"></i>
                        <p class="text-lg">No pending reports</p>
                        <p class="text-sm">Reports from players will appear here</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = reports.map(report => `
                <div class="card p-5 rounded-xl ${report.status === 'pending' ? 'border-l-4 border-yellow-500' : 'border-l-4 border-green-500'}">
                    <div class="flex items-center justify-between mb-4">
                        <span class="badge ${report.status === 'pending' ? 'bg-yellow-500/20 text-yellow-400' : 'bg-green-500/20 text-green-400'}">
                            ${report.status.toUpperCase()}
                        </span>
                        <span class="text-sm" style="color: var(--text-secondary)">${new Date(report.timestamp).toLocaleString()}</span>
                    </div>
                    <div class="grid grid-cols-2 gap-4 mb-3">
                        <div>
                            <p class="text-xs" style="color: var(--text-secondary)">Reporter</p>
                            <p class="font-medium">${report.reporter?.name || 'Unknown'}</p>
                        </div>
                        <div>
                            <p class="text-xs" style="color: var(--text-secondary)">Reported</p>
                            <p class="font-medium text-red-400">${report.reported?.name || 'Unknown'}</p>
                        </div>
                    </div>
                    <p class="text-sm mb-4" style="color: var(--text-secondary)">${report.reason}</p>
                    ${report.status === 'pending' ? `
                        <div class="flex gap-2">
                            <button onclick="resolveReport('${report.id}')" class="btn-success px-3 py-1.5 rounded-lg text-white text-sm">Resolve</button>
                            <button onclick="banFromReport('${report.id}')" class="btn-danger px-3 py-1.5 rounded-lg text-white text-sm">Ban Player</button>
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function resolveReport(reportId) {
            const report = reports.find(r => r.id === reportId);
            if (report) {
                report.status = 'resolved';
                saveData();
                renderReports();
                updateStats();
                showToast('Report resolved!', 'success');
            }
        }

        function banFromReport(reportId) {
            const report = reports.find(r => r.id === reportId);
            if (report) {
                document.getElementById('quickBanPlayer').value = report.reported?.id || '';
                document.getElementById('quickBanReason').value = `Reported by ${report.reporter?.name}: ${report.reason}`;
                showSection('bans');
            }
        }

        async function refreshReports() {
            showToast('Refreshing reports...', 'info');
            // In a real implementation, this would fetch reports from DataStore
            showToast('Reports refreshed!', 'success');
        }

        // ==================== ADMIN LOGS ====================
        function renderLogs() {
            const container = document.getElementById('adminLogsList');
            
            if (adminLogs.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12" style="color: var(--text-secondary)">
                        <i class="fas fa-clipboard-list text-5xl mb-4 opacity-30"></i>
                        <p class="text-lg">No logs yet</p>
                    </div>
                `;
                return;
            }
            
            const actionConfig = {
                login: { bg: 'bg-blue-500/20', text: 'text-blue-400', icon: 'fa-sign-in-alt' },
                logout: { bg: 'bg-gray-500/20', text: 'text-gray-400', icon: 'fa-sign-out-alt' },
                ban: { bg: 'bg-red-500/20', text: 'text-red-400', icon: 'fa-ban' },
                unban: { bg: 'bg-green-500/20', text: 'text-green-400', icon: 'fa-user-check' },
                kick: { bg: 'bg-orange-500/20', text: 'text-orange-400', icon: 'fa-user-slash' },
                announcement: { bg: 'bg-purple-500/20', text: 'text-purple-400', icon: 'fa-bullhorn' },
                shutdown: { bg: 'bg-red-500/20', text: 'text-red-400', icon: 'fa-power-off' },
                api_key: { bg: 'bg-yellow-500/20', text: 'text-yellow-400', icon: 'fa-key' },
                delete: { bg: 'bg-red-500/20', text: 'text-red-400', icon: 'fa-trash' }
            };
            
            container.innerHTML = adminLogs.map(log => {
                const config = actionConfig[log.action] || { bg: 'bg-gray-500/20', text: 'text-gray-400', icon: 'fa-circle' };
                const game = games.find(g => g.id === log.gameId);
                return `
                    <div class="log-entry pl-4 py-3 rounded-r-xl" style="background: var(--bg-tertiary)">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center gap-3">
                                <span class="badge ${config.bg} ${config.text} flex items-center gap-1">
                                    <i class="fas ${config.icon} text-xs"></i>${log.action.toUpperCase()}
                                </span>
                                <span class="font-medium">${log.admin}</span>
                            </div>
                            <span class="text-xs" style="color: var(--text-secondary)">${log.timestamp}</span>
                        </div>
                        <p class="text-sm">${log.details}</p>
                        ${game ? `<p class="text-xs mt-1" style="color: var(--text-secondary)"><i class="fas fa-gamepad mr-1"></i>${game.name}</p>` : ''}
                    </div>
                `;
            }).join('');
            
            // Populate admin filter
            const uniqueAdmins = [...new Set(adminLogs.map(l => l.admin))];
            document.getElementById('logFilterAdmin').innerHTML = '<option value="all">All Admins</option>' + 
                uniqueAdmins.map(a => `<option value="${a}">${a}</option>`).join('');
        }

        function filterLogs() {
            const adminFilter = document.getElementById('logFilterAdmin').value;
            const actionFilter = document.getElementById('logFilterAction').value;
            
            let filtered = [...adminLogs];
            if (adminFilter !== 'all') filtered = filtered.filter(l => l.admin === adminFilter);
            if (actionFilter !== 'all') filtered = filtered.filter(l => l.action === actionFilter);
            
            const container = document.getElementById('adminLogsList');
            
            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12" style="color: var(--text-secondary)">
                        <i class="fas fa-search text-4xl mb-3 opacity-30"></i>
                        <p>No logs found</p>
                    </div>
                `;
                return;
            }
            
            const actionConfig = {
                login: { bg: 'bg-blue-500/20', text: 'text-blue-400', icon: 'fa-sign-in-alt' },
                logout: { bg: 'bg-gray-500/20', text: 'text-gray-400', icon: 'fa-sign-out-alt' },
                ban: { bg: 'bg-red-500/20', text: 'text-red-400', icon: 'fa-ban' },
                unban: { bg: 'bg-green-500/20', text: 'text-green-400', icon: 'fa-user-check' },
                kick: { bg: 'bg-orange-500/20', text: 'text-orange-400', icon: 'fa-user-slash' },
                announcement: { bg: 'bg-purple-500/20', text: 'text-purple-400', icon: 'fa-bullhorn' },
                shutdown: { bg: 'bg-red-500/20', text: 'text-red-400', icon: 'fa-power-off' }
            };
            
            container.innerHTML = filtered.map(log => {
                const config = actionConfig[log.action] || { bg: 'bg-gray-500/20', text: 'text-gray-400', icon: 'fa-circle' };
                return `
                    <div class="log-entry pl-4 py-3 rounded-r-xl" style="background: var(--bg-tertiary)">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center gap-3">
                                <span class="badge ${config.bg} ${config.text} flex items-center gap-1">
                                    <i class="fas ${config.icon} text-xs"></i>${log.action.toUpperCase()}
                                </span>
                                <span class="font-medium">${log.admin}</span>
                            </div>
                            <span class="text-xs" style="color: var(--text-secondary)">${log.timestamp}</span>
                        </div>
                        <p class="text-sm">${log.details}</p>
                    </div>
                `;
            }).join('');
        }

        // ==================== ADMIN MANAGEMENT ====================
        function renderAdminList() {
            const container = document.getElementById('adminList');
            
            const roleConfig = {
                developer: { bg: 'bg-purple-500', icon: 'fa-code' },
                admin: { bg: 'bg-blue-500', icon: 'fa-user-shield' },
                moderator: { bg: 'bg-green-500', icon: 'fa-user' }
            };
            
            container.innerHTML = admins.map(admin => {
                const config = roleConfig[admin.role] || roleConfig.moderator;
                return `
                    <div class="flex items-center justify-between p-4 rounded-xl" style="background: var(--bg-tertiary)">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full ${config.bg} flex items-center justify-center text-white font-bold">${admin.username.charAt(0).toUpperCase()}</div>
                            <div>
                                <p class="font-medium">${admin.username}</p>
                                <span class="badge ${config.bg}/20 text-xs">${admin.role.toUpperCase()}</span>
                            </div>
                        </div>
                        ${admin.role !== 'developer' && currentUser?.role === 'developer' ? `
                            <button onclick="deleteAdmin('${admin.username}')" class="btn-danger px-3 py-1.5 rounded-lg text-white text-sm">
                                <i class="fas fa-trash"></i>
                            </button>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        function createAdmin() {
            if (currentUser.role !== 'developer') {
                showToast('Only developers can create admins!', 'error');
                return;
            }
            
            const username = document.getElementById('newAdminUsername').value;
            const password = document.getElementById('newAdminPassword').value;
            const role = document.getElementById('newAdminRole').value;
            
            if (!username || !password) {
                showToast('Please fill all fields!', 'error');
                return;
            }
            
            if (admins.find(a => a.username === username)) {
                showToast('Username already exists!', 'error');
                return;
            }
            
            admins.push({ username, password, role });
            saveData();
            renderAdminList();
            
            document.getElementById('newAdminUsername').value = '';
            document.getElementById('newAdminPassword').value = '';
            
            showToast(`Admin ${username} created!`, 'success');
            addLog('create', `Created admin: ${username} (${role})`);
        }

        function deleteAdmin(username) {
            if (currentUser.role !== 'developer') {
                showToast('Only developers can delete admins!', 'error');
                return;
            }
            
            if (confirm(`Delete admin ${username}?`)) {
                admins = admins.filter(a => a.username !== username);
                saveData();
                renderAdminList();
                showToast(`Admin ${username} deleted!`, 'success');
                addLog('delete', `Deleted admin: ${username}`);
            }
        }

        // ==================== SETTINGS ====================
        function changePassword() {
            const newPassword = document.getElementById('newPassword').value;
            
            if (!newPassword) {
                showToast('Please enter new password!', 'error');
                return;
            }
            
            const admin = admins.find(a => a.username === currentUser.username);
            if (admin) {
                admin.password = newPassword;
                currentUser.password = newPassword;
                saveData();
                document.getElementById('newPassword').value = '';
                showToast('Password changed!', 'success');
                addLog('update', 'Changed password');
            }
        }

        // ==================== LUA SCRIPT ====================
        function copyScript() {
            const script = document.getElementById('luaScript').textContent;
            navigator.clipboard.writeText(script).then(() => {
                showToast('Script copied to clipboard!', 'success');
            });
        }

        // ==================== MODAL ====================
        function closeModal() {
            document.getElementById('modal').classList.add('hidden');
        }

        // ==================== RECENT ACTIVITY ====================
        function renderRecentActivity() {
            const container = document.getElementById('recentActivity');
            const recentLogs = adminLogs.slice(0, 5);
            
            if (recentLogs.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8" style="color: var(--text-secondary)">
                        <i class="fas fa-clipboard-list text-4xl mb-3 opacity-30"></i>
                        <p>No recent activity</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = recentLogs.map(log => `
                <div class="log-entry pl-4 py-3 rounded-r-lg">
                    <div class="flex items-center justify-between">
                        <p class="text-sm"><span class="font-medium">${log.admin}</span></p>
                        <span class="text-xs" style="color: var(--text-secondary)">${log.timestamp}</span>
                    </div>
                    <p class="text-sm mt-1" style="color: var(--text-secondary)">${log.details}</p>
                </div>
            `).join('');
        }

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'light') {
                isDarkMode = false;
                document.body.classList.add('light-theme');
                document.getElementById('themeToggle').classList.add('active');
            }
            
            document.getElementById('loginPassword').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') login();
            });
            
            document.getElementById('loginUsername').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') login();
            });
            
            document.getElementById('modal').addEventListener('click', (e) => {
                if (e.target === document.getElementById('modal')) closeModal();
            });
        });
    </script>
</body>
</html>
